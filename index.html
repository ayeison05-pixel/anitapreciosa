<!DOCTYPE html><html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Preciosa</title>
  <meta name="theme-color" content="#00A6FF">
  <link rel="manifest" href="manifest.json">
  <link rel="icon" href="icon.png">
  <!-- Fuentes -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;600&family=Inter:wght@300;400;500&family=Courier+Prime:wght@400;700&display=swap" rel="stylesheet">
  <!-- √çconos profesionales -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    /* =====================
       CONFIGURACI√ìN GENERAL
       ===================== */

    /* Colores base del proyecto */
    :root {
      --azul-principal: #00A6FF;      /* Azul base rom√°ntico */
      --azul-profundo: #0b3c5d;       /* Azul oscuro para t√≠tulos */
      --texto-principal: #1f2933;     /* Texto normal */
      --texto-suave: #6b7280;         /* Texto secundario */
    }

    /* Reset b√°sico */
    * {
      box-sizing: border-box;
    }

    /* Fondo general de la app */
    body {
      margin: 0;
      font-family: 'Inter', sans-serif; /* Fuente base */
      background: linear-gradient(180deg, #00A6FF 0%, #6fd3ff 100%);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 24px;
      -webkit-user-select: none; /* Chrome, Safari */
      -moz-user-select: none;    /* Firefox */
      -ms-user-select: none;     /* IE/Edge */
      user-select: none;         /* Standard */
    }

    /* Contenedor principal (solo layout, sin estilo visual) */
    .layout {
      width: 100%;
      max-width: 420px;
      display: flex;
      flex-direction: column;
      gap: 32px; /* Separaci√≥n entre secciones */
      text-align: center;
    }

    /* =====================
       T√çTULO
       ===================== */

    .titulo {
      font-family: 'Playfair Display', serif; /* Fuente elegante */
      font-size: 4rem;
      color: snow;
      text-shadow: 2px 1px 2.5px black;
    }

    /* =====================
       CONTADOR DE TIEMPO
       ===================== */

    .contador {
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .contador-tiempo {
      font-family: 'Playfair Display', serif; /* Da car√°cter rom√°ntico */
      font-size: 4rem;
      color: azure;
      white-space: nowrap; /* Evita saltos de l√≠nea */
    }

    .contador-label {
      margin-top: 6px;
      font-size: 1.5rem;
      color: black;
    }

    /* =====================
       MENSAJE INTERACTIVO
       ===================== */

    .mensaje {
      font-size: 1.8rem;
      color: var(--texto-principal);
      min-height: 42px;
    }

    .mensaje-placeholder {
      font-size: 1.05rem;
      color: var(--azul-profundo);
      cursor: pointer;
      animation: pulse 1.8s infinite; /* Llamado de atenci√≥n sutil */
    }

    /* Animaci√≥n del "presiona aqu√≠" */
    @keyframes pulse {
      0% { opacity: 1; }
      50% { opacity: 0.4; }
      100% { opacity: 1; }
    }

    /* =====================
       BOT√ìN DE ENTRADA
       ===================== */

    .boton-entrar {
      background: var(--azul-principal);
      color: white;
      border: none;
      padding: 16px;
      border-radius: 18px;
      font-size: 1rem;
      font-weight: 500;
      cursor: pointer;
      box-shadow: 0 12px 24px rgba(0, 166, 255, 0.35);
      margin-bottom: 8px; /* Espacio para la barra de audio */
    }

    .boton-entrar:active {
      transform: scale(0.97);
    }

    /* =====================
       REPRODUCTOR DE AUDIO MEJORADO
       ===================== */
    .reproductor-audio {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 18px;
      padding: 16px 22px;
      background: rgba(255, 255, 255, 0.12);
      border-radius: 20px;
      backdrop-filter: blur(12px);
      border: 1px solid rgba(255, 255, 255, 0.25);
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
      margin-top: 8px;
      transition: all 0.3s ease;
    }

    .reproductor-audio:active {
      background: rgba(255, 255, 255, 0.18);
      transform: scale(0.99);
    }

    .boton-audio {
      background: rgba(255, 255, 255, 0.95);
      border: none;
      width: 48px;
      height: 48px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 1.3rem;
      color: var(--azul-principal);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
      transition: all 0.25s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }

    .boton-audio:active {
      transform: scale(0.88);
      background: white;
      box-shadow: 0 3px 10px rgba(0, 0, 0, 0.25);
    }

    .boton-audio.playing {
      background: var(--azul-principal);
      color: white;
      box-shadow: 0 6px 20px rgba(0, 166, 255, 0.5);
    }

    .tiempo-audio {
      font-family: 'Courier Prime', monospace;
      font-size: 0.95rem;
      font-weight: 500;
      color: white;
      min-width: 100px;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
      letter-spacing: 0.5px;
      opacity: 0.9;
    }

    .barra-progreso {
      flex-grow: 1;
      height: 5px;
      background: rgba(255, 255, 255, 0.15);
      border-radius: 3px;
      overflow: hidden;
      position: relative;
      cursor: pointer;
    }

    .progreso-actual {
      position: absolute;
      top: 0;
      left: 0;
      height: 100%;
      background: linear-gradient(90deg, white, rgba(255, 255, 255, 0.9));
      width: 0%;
      border-radius: 3px;
      transition: width 0.08s linear;
      box-shadow: 0 0 10px rgba(255, 255, 255, 0.7);
    }

    /* Indicador de tiempo al pasar sobre la barra */
    .barra-progreso:hover::after {
      content: attr(data-tiempo-hover);
      position: absolute;
      top: -30px;
      background: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 4px 8px;
      border-radius: 6px;
      font-size: 0.8rem;
      font-family: 'Courier Prime', monospace;
      white-space: nowrap;
      pointer-events: none;
      opacity: 0;
      transform: translateX(-50%);
      transition: opacity 0.2s;
    }

    .barra-progreso:hover::after {
      opacity: 1;
    }

    /* =====================
       NUEVOS ESTILOS PARA LA L√çNEA DE TIEMPO
       ===================== */
    
    /* Pantalla de l√≠nea de tiempo */
    .timeline-screen {
      display: none;
      width: 100%;
      max-width: 420px;
      flex-direction: column;
      gap: 20px;
    }
    
    .timeline-header {
      font-family: 'Playfair Display', serif;
      font-size: 2.5rem;
      color: snow;
      text-shadow: 2px 1px 2.5px black;
      margin-bottom: 10px;
      text-align: center;
    }
    
    .timeline-container {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 20px;
      padding: 20px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
      max-height: 520px;
      overflow-y: auto;
      -webkit-user-select: text;
      -moz-user-select: text;
      -ms-user-select: text;
      user-select: text;
    }
    
    .timeline-item {
      position: relative;
      padding-left: 32px;
      margin-bottom: 24px;
      text-align: left;
      border-left: 3px solid var(--azul-principal);
    }
    
    .timeline-item:last-child {
      margin-bottom: 0;
    }
    
    .timeline-dot {
      position: absolute;
      left: -10px;
      top: 0;
      width: 20px;
      height: 20px;
      background: var(--azul-principal);
      border-radius: 50%;
      border: 3px solid white;
      box-shadow: 0 0 0 3px var(--azul-principal);
    }
    
    .timeline-date {
      font-weight: 600;
      color: var(--azul-profundo);
      font-size: 1.1rem;
      margin-bottom: 6px;
      font-family: 'Courier Prime', monospace; /* Nueva fuente tipo m√°quina */
      letter-spacing: 0.5px;
    }
    
    .timeline-content {
      color: var(--texto-principal);
      font-size: 1rem;
      line-height: 1.6; /* Aumentado para mejor legibilidad en monoespaciada */
      font-family: 'Courier Prime', monospace; /* Nueva fuente tipo m√°quina */
      letter-spacing: 0.3px;
    }

    .timeline-total {
      font-family: 'Playfair Display', serif;
      font-size: 1.8rem;
      color: azure;
      padding: 14px;
      background: rgba(0, 166, 255, 0.25);
      border-radius: 16px;
      backdrop-filter: blur(10px);
    }
    
    .boton-volver {
      background: white;
      color: var(--azul-principal);
      border: 2px solid var(--azul-principal);
      padding: 14px;
      border-radius: 18px;
      font-size: 1rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .boton-volver:hover {
      background: var(--azul-principal);
      color: white;
    }
    
    .boton-volver:active {
      transform: scale(0.97);
    }

    /* =====================
       MODAL DE FOTOS (√ÅLBUM) - NUEVO
       ===================== */

    .modal-album {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.92);
      z-index: 1000;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      padding: 20px;
    }

    .modal-contenido {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 20px;
      width: 90%;
      max-width: 500px;
      max-height: 85vh;
      overflow: hidden;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
      animation: aparecer 0.3s ease;
    }

    @keyframes aparecer {
      from { opacity: 0; transform: scale(0.9); }
      to { opacity: 1; transform: scale(1); }
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 18px 24px;
      background: var(--azul-principal);
      color: white;
    }

    .modal-titulo {
      font-family: 'Playfair Display', serif;
      font-size: 1.6rem;
      margin: 0;
    }

    .cerrar-modal {
      background: none;
      border: none;
      color: white;
      font-size: 1.8rem;
      cursor: pointer;
      padding: 0;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      transition: background 0.2s;
    }

    .cerrar-modal:hover {
      background: rgba(255, 255, 255, 0.2);
    }

    .fotos-container {
      padding: 20px;
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 16px;
      overflow-y: auto;
      max-height: 60vh;
    }

    .foto-item {
      aspect-ratio: 1/1;
      border-radius: 12px;
      overflow: hidden;
      cursor: pointer;
      background: #f0f0f0;
      position: relative;
      transition: transform 0.3s;
    }

    .foto-item:hover {
      transform: scale(1.03);
    }

    .foto-item img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .modal-ampliada {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.95);
      z-index: 1001;
      justify-content: center;
      align-items: center;
      flex-direction: column;
    }

    .modal-ampliada img {
      max-width: 90%;
      max-height: 80vh;
      border-radius: 12px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
    }

    .cerrar-ampliada {
      margin-top: 20px;
      background: var(--azul-principal);
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 50px;
      font-size: 1rem;
      cursor: pointer;
      font-weight: 500;
    }

    .boton-album {
      background: white;
      color: var(--azul-principal);
      border: 2px solid var(--azul-principal);
      padding: 14px;
      border-radius: 18px;
      font-size: 1rem;
      font-weight: 500;
      cursor: pointer;
      margin-top: 10px;
      transition: all 0.3s;
    }

    .boton-album:hover {
      background: var(--azul-principal);
      color: white;
    }

    /* =====================
       NOTIFICACI√ìN DE ACTUALIZACI√ìN - NUEVO
       ===================== */

    .notificacion-update {
      display: none;
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: linear-gradient(135deg, #00A6FF, #0b3c5d);
      color: white;
      padding: 16px 24px;
      border-radius: 16px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      z-index: 2000;
      align-items: center;
      gap: 15px;
      animation: slideUp 0.5s ease;
      max-width: 90%;
      border: 2px solid rgba(255, 255, 255, 0.2);
      backdrop-filter: blur(10px);
    }

    @keyframes slideUp {
      from { 
        opacity: 0; 
        transform: translateX(-50%) translateY(100px); 
      }
      to { 
        opacity: 1; 
        transform: translateX(-50%) translateY(0); 
      }
    }

    .notificacion-texto {
      font-size: 1rem;
      font-weight: 500;
      text-align: center;
      flex-grow: 1;
    }

    .notificacion-boton {
      background: white;
      color: #00A6FF;
      border: none;
      padding: 10px 20px;
      border-radius: 50px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      white-space: nowrap;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    }

    .notificacion-boton:hover {
      background: #f0f0f0;
      transform: translateY(-2px);
    }

    .cerrar-notificacion {
      background: transparent;
      color: white;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      width: 30px;
      height: 30px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      transition: background 0.2s;
    }

    .cerrar-notificacion:hover {
      background: rgba(255, 255, 255, 0.2);
    }
  </style>
</head>
<body>
  <!-- PANTALLA DE INICIO -->
  <div class="layout">
    <div class="titulo">Preciosa</div>
    
    <div class="contador">
      <div class="contador-tiempo" id="tiempo">0</div>
      <div class="contador-label">26 de noviembre de 2025</div>
    </div>
    
    <div>
      <div class="mensaje-placeholder" id="placeholder">presiona aqu√≠ üíô</div>
      <div class="mensaje" id="mensaje"></div>
    </div>
    
    <button class="boton-entrar">Entrar</button>
    
    <!-- REPRODUCTOR DE AUDIO MEJORADO -->
    <div class="reproductor-audio" id="reproductorAudio">
      <button class="boton-audio" id="botonPlayPause">
        <i class="fas fa-play"></i>
      </button>
      
      <div class="tiempo-audio" id="tiempoActual">0:00 / 0:00</div>
      
      <div class="barra-progreso" id="barraProgreso">
        <div class="progreso-actual" id="progresoActual"></div>
      </div>
    </div>

    <!-- BOT√ìN PARA ABRIR √ÅLBUM - NUEVO -->
    <button class="boton-album" id="botonAlbum">Ver √Ålbum de Fotos</button>
  </div>
  
  <!-- PANTALLA DE L√çNEA DE TIEMPO -->
  <div class="timeline-screen" id="timelineScreen">
    <div class="timeline-header">Jeison & Anita</div>
    <div class="timeline-container" id="timelineContainer"></div>
    <div class="timeline-total" id="timelineTotal">0 d√≠as juntos</div>
    <button class="boton-volver" id="botonVolver">Volver al Inicio</button>
  </div>

  <!-- MODAL DEL √ÅLBUM DE FOTOS - NUEVO -->
  <div class="modal-album" id="modalAlbum">
    <div class="modal-contenido">
      <div class="modal-header">
        <h2 class="modal-titulo">Jeison & Anita üíï</h2>
        <button class="cerrar-modal" id="cerrarModal">&times;</button>
      </div>
      <div class="fotos-container" id="fotosContainer">
        <!-- Las fotos se cargar√°n din√°micamente aqu√≠ -->
      </div>
    </div>
  </div>

  <!-- MODAL PARA FOTO AMPLIADA - NUEVO -->
  <div class="modal-ampliada" id="modalAmpliada">
    <img id="fotoAmpliada" src="" alt="Foto ampliada">
    <button class="cerrar-ampliada" id="cerrarAmpliada">Cerrar</button>
  </div>

  <!-- NOTIFICACI√ìN DE ACTUALIZACI√ìN - NUEVO -->
  <div class="notificacion-update" id="notificacionUpdate">
    <div class="notificacion-texto">
      üíô <strong>¬°Nueva actualizaci√≥n disponible!</strong> <br>
      Hay fotos nuevas en nuestro √°lbum
    </div>
    <button class="notificacion-boton" id="botonActualizarAhora">
      Actualizar Ahora
    </button>
    <button class="cerrar-notificacion" id="cerrarNotificacion">&times;</button>
  </div>

  <!-- AUDIO (oculto) - SIN LOOP -->
  <audio id="audioFondo">
    <source src="audio1.m4a" type="audio/mp4">
    Tu navegador no soporta el elemento de audio.
  </audio>
  
  <script>
  /* VARIABLES GLOBALES */
  let index = 0;
  let escribiendo = false;
  const inicio = new Date('2025-11-26T11:54:00');
  const texto = 'hola Anita preciosa ‚ù§Ô∏è';

  /* VARIABLES PARA AUDIO MEJORADO */
  const audio = document.getElementById('audioFondo');
  const botonPlayPause = document.getElementById('botonPlayPause');
  const iconoPlayPause = botonPlayPause.querySelector('i');
  const tiempoActual = document.getElementById('tiempoActual');
  const barraProgreso = document.getElementById('barraProgreso');
  const progresoActual = document.getElementById('progresoActual');

  /* FUNCIONES B√ÅSICAS */
  function actualizarTiempo() {
    const ahora = new Date();
    let diff = ahora - inicio;
    const dias = Math.floor(diff / (1000 * 60 * 60 * 24));
    diff %= (1000 * 60 * 60 * 24);
    const horas = Math.floor(diff / (1000 * 60 * 60));
    diff %= (1000 * 60 * 60);
    const minutos = Math.floor(diff / (1000 * 60));
    document.getElementById('tiempo').textContent = `${dias}d ${horas}h ${minutos}m`;
  }

  function escribirMensaje() {
    if (index < texto.length) {
      document.getElementById('mensaje').textContent += texto.charAt(index);
      index++;
      setTimeout(escribirMensaje, 80);
    }
  }

  function formatearFecha(fecha) {
    return fecha.toLocaleDateString('es-ES', {
      day: 'numeric',
      month: 'long',
      year: 'numeric'
    });
  }

  /* FUNCIONES PARA AUDIO MEJORADO */
  function formatearTiempo(segundos) {
    const min = Math.floor(segundos / 60);
    const sec = Math.floor(segundos % 60);
    return `${min}:${sec < 10 ? '0' : ''}${sec}`;
  }

  function actualizarInterfazAudio() {
    if (audio.duration) {
      // Actualizar tiempo
      tiempoActual.textContent = `${formatearTiempo(audio.currentTime)} / ${formatearTiempo(audio.duration)}`;
      
      // Actualizar barra de progreso
      const porcentaje = (audio.currentTime / audio.duration) * 100;
      progresoActual.style.width = `${porcentaje}%`;
      
      // Actualizar icono y estado del bot√≥n
      if (audio.paused) {
        iconoPlayPause.className = 'fas fa-play';
        botonPlayPause.classList.remove('playing');
      } else {
        iconoPlayPause.className = 'fas fa-pause';
        botonPlayPause.classList.add('playing');
      }
    } else {
      tiempoActual.textContent = '0:00 / 0:00';
    }
  }

  function togglePlayPause() {
    if (audio.paused) {
      // En m√≥viles, necesitamos una interacci√≥n directa para reproducir
      const promesa = audio.play();
      if (promesa !== undefined) {
        promesa.catch(error => {
          console.log("Reproducci√≥n autom√°tica prevenida:", error);
          // Si falla, mostramos mensaje amigable
          alert("Toca el bot√≥n de play para iniciar la m√∫sica");
        });
      }
    } else {
      audio.pause();
    }
    actualizarInterfazAudio();
  }

  function establecerProgreso(event) {
    if (!audio.duration) return;
    
    const rect = barraProgreso.getBoundingClientRect();
    const clickX = event.clientX - rect.left;
    const porcentaje = Math.min(Math.max(clickX / rect.width, 0), 1);
    
    audio.currentTime = porcentaje * audio.duration;
    actualizarInterfazAudio();
  }

  function actualizarTiempoHover(event) {
    if (!audio.duration) return;
    
    const rect = barraProgreso.getBoundingClientRect();
    const hoverX = event.clientX - rect.left;
    const porcentajeHover = Math.min(Math.max(hoverX / rect.width, 0), 1);
    const tiempoHover = porcentajeHover * audio.duration;
    
    barraProgreso.setAttribute('data-tiempo-hover', formatearTiempo(tiempoHover));
  }

  /* FUNCIONES PARA TIMELINE */
  function generarHitios() {
    const hitos = [];
    const ahora = new Date();
    const fechaInicio = new Date('2025-11-26T11:54:00');
    const totalDias = Math.floor((ahora - fechaInicio) / (1000 * 60 * 60 * 24));
    
    // Hitos principales
    if (totalDias >= 0) {
      hitos.push({
        fecha: new Date('2025-11-26T11:54:00'),
        contenido: '<strong>nuestro inicio ‚ù§Ô∏è</strong> <br>¬°TE AMO! y quiero que...<strong>..seamos novios.</strong><br>Respuesta: <strong>S√≠, s√≠ aceptoüíï</strong>'
      });
    }
    
    const fecha7Dic = new Date('2025-12-07T12:00:00');
    if (ahora >= fecha7Dic) {
      hitos.push({
        fecha: fecha7Dic,
        contenido: `
  <strong>Anuncio de Noviazgo en Terrazas</strong>
  <ul style="text-align: left; margin: 8px 0; padding-left: 20px;">
    <li>D√≠a especial</li>
    <li>Familia presente</li>
    <li>Momento inolvidable</li>
  </ul>
  Y yo: <strong>happyüòç</strong>
  <ul style="text-align: left; margin: 8px 0; padding-left: 20px;">
      <li>Almuerzo y tarde de domingo Juntos ‚ù§Ô∏è</li>
      
      </ul>
`
      });
    }
    
    const fecha13Dic = new Date('2025-12-13T12:00:00');
    if (ahora >= fecha13Dic) {
      hitos.push({
        fecha: fecha13Dic,
        contenido: `<strong>Anuncio de Noviazgo (sabana)</strong>
  <ul style="text-align: left; margin: 8px 0; padding-left: 20px;">
    <li>D√≠a especial en la sabana</li>
    <li>Invitaci√≥n a comer juntos ‚ù§Ô∏è</li>
    <li>Familia y amigos celebrando</li>
    <li>Momento inolvidable</li>
  </ul>
  Y yo segu√≠a: <strong>happyüòç</strong>`
      });
    }
    
    if (totalDias >= 30) {
      const primerMes = new Date(fechaInicio);
      primerMes.setMonth(primerMes.getMonth() + 1);
      hitos.push({
        fecha: primerMes,
        contenido: '¬°Un mes juntos! Cada d√≠a contigo es un regalo.'
      });
    }
    
    if (totalDias >= 100) {
      const cienDias = new Date(fechaInicio);
      cienDias.setDate(cienDias.getDate() + 100);
      hitos.push({
        fecha: cienDias,
        contenido: '100 d√≠as de sonrisas, complicidad y momentos √∫nicos.'
      });
    }
    
    if (totalDias >= 365) {
      const primerAnio = new Date(fechaInicio);
      primerAnio.setFullYear(primerAnio.getFullYear() + 1);
      hitos.push({
        fecha: primerAnio,
        contenido: '¬°Un a√±o de felicidad! Eres lo mejor que me ha pasado.'
      });
    }
    
    for (let i = 2; i <= Math.floor(totalDias / 30); i++) {
      const mes = new Date(fechaInicio);
      mes.setMonth(mes.getMonth() + i);
      if (mes < ahora) {
        let contenido;
        if (i === 3) {
          contenido = `3 meses juntos preciosa ‚ù§Ô∏è te amo un mont√≥n, han sido los 93 d√≠as m√°s bonitos de mi vida, deseo que sean muchos d√≠as m√°s, TE AMO ANITA PRECIOSA.`;
        } else {
          contenido = `${i} meses juntos. Mi amor por ti crece cada d√≠a m√°s. <strong>te amo mi ni√±a preciosa üíï</strong>`;
        }
        hitos.push({
          fecha: mes,
          contenido: contenido
        });
      }
    }
    
    hitos.push({
      fecha: ahora,
      contenido: 'Hoy, en este momento. Sigues siendo la persona m√°s importante en mi vida.'
    });
    
    hitos.sort((a, b) => a.fecha - b.fecha);
    return hitos;
  }

  function generarTimeline() {
    const container = document.getElementById('timelineContainer');
    const hitos = generarHitios();
    
    container.innerHTML = '';
    
    hitos.forEach((hito, i) => {
      const item = document.createElement('div');
      item.className = 'timeline-item';
      
      item.innerHTML = `
        <div class="timeline-dot"></div>
        <div class="timeline-date">${formatearFecha(hito.fecha)}</div>
        <div class="timeline-content">${hito.contenido}</div>
      `;
      
      container.appendChild(item);
    });
    
    const fechaInicio = new Date('2025-11-26T11:54:00');
    const ahora = new Date();
    const totalDias = Math.floor((ahora - fechaInicio) / (1000 * 60 * 60 * 24));
    const totalMeses = Math.floor(totalDias / 30);
    const totalAnios = Math.floor(totalDias / 365);
    
    let textoTotal = `${totalDias} d√≠as juntos`;
    if (totalAnios > 0) {
      textoTotal = `${totalAnios} a√±o${totalAnios > 1 ? 's' : ''}, ${totalMeses % 12} mes${totalMeses % 12 !== 1 ? 'es' : ''} y ${totalDias % 30} d√≠a${totalDias % 30 !== 1 ? 's' : ''}`;
    } else if (totalMeses > 0) {
      textoTotal = `${totalMeses} mes${totalMeses > 1 ? 'es' : ''} y ${totalDias % 30} d√≠a${totalDias % 30 !== 1 ? 's' : ''}`;
    }
    
    document.getElementById('timelineTotal').textContent = textoTotal;
  }

  /* =====================
     √ÅLBUM DE FOTOS - NUEVO
     ===================== */

  // Array con las fotos (ACTUALIZA ESTOS NOMBRES CON TUS FOTOS REALES)
  const fotosAlbum = [
    { src: 'foto1.jpg', desc: 'Nuestro primer d√≠a ‚ù§Ô∏è' },
    { src: 'foto2.jpg', desc: 'D√≠a especial' },
    { src: 'foto3.jpg', desc: 'Momentos felices' },
    { src: 'foto4.jpg', desc: 'Sonrisas juntos' },
    { src: 'foto5.jpg', desc: 'Aventuras compartidas' },
    { src: 'foto6.jpg', desc: 'Te amo üíï' },
    { src: 'foto7.jpg', desc: 'mi amor' },
    { src: 'foto8.jpg', desc: 'Te amo, preciosa'},
    { src: 'foto9.jpg', desc: 'Te amo, mi preciosa'},
    { src: 'foto10.jpg', desc: 'Te amoo, preciosa'},
    { src: 'foto11.jpg', desc: 'Te amo, Anita preciosa'},
    { src: 'foto12.jpg', desc: 'Te amo, solo a ti preciosa'},
    { src: 'foto13.jpg', desc: 'Te amo, preciosa mia.'}
  ];

  function cargarAlbum() {
    const container = document.getElementById('fotosContainer');
    container.innerHTML = '';
    
    fotosAlbum.forEach((foto, index) => {
      const divFoto = document.createElement('div');
      divFoto.className = 'foto-item';
      divFoto.innerHTML = `
        <img src="${foto.src}" alt="${foto.desc}" loading="lazy" data-index="${index}">
      `;
      container.appendChild(divFoto);
      
      divFoto.querySelector('img').addEventListener('click', function() {
        const fotoIndex = this.getAttribute('data-index');
        mostrarFotoAmpliada(fotoIndex);
      });
    });
  }

  function mostrarAlbum() {
    cargarAlbum();
    document.getElementById('modalAlbum').style.display = 'flex';
  }

  function cerrarAlbum() {
    document.getElementById('modalAlbum').style.display = 'none';
  }

  function mostrarFotoAmpliada(index) {
    const foto = fotosAlbum[index];
    document.getElementById('fotoAmpliada').src = foto.src;
    document.getElementById('modalAmpliada').style.display = 'flex';
  }

  function cerrarFotoAmpliada() {
    document.getElementById('modalAmpliada').style.display = 'none';
  }

  /* =====================
     SISTEMA DE ACTUALIZACI√ìN PWA - NUEVO
     ===================== */

  let registrationSW = null;

  function mostrarNotificacionUpdate() {
    const notificacion = document.getElementById('notificacionUpdate');
    notificacion.style.display = 'flex';
    
    setTimeout(() => {
      if (notificacion.style.display === 'flex') {
        ocultarNotificacionUpdate();
      }
    }, 30000);
  }

  function ocultarNotificacionUpdate() {
    document.getElementById('notificacionUpdate').style.display = 'none';
  }

  function actualizarPWA() {
    if (registrationSW && registrationSW.waiting) {
      registrationSW.waiting.postMessage({ type: 'SKIP_WAITING' });
      
      setTimeout(() => {
        window.location.reload();
        alert('üéâ ¬°App actualizada! Ahora puedes ver nuestras nuevas fotos üíï');
      }, 1000);
    } else {
      window.location.reload();
    }
  }

  function chequearActualizaciones() {
    if (registrationSW) {
      registrationSW.update();
    }
  }

  /* CONFIGURACI√ìN DE EVENTOS */
  document.addEventListener('DOMContentLoaded', function() {
    // Configuraci√≥n inicial del audio (SIN LOOP)
    audio.loop = false;
    audio.volume = 0.7; // Volumen fijo al 70%
    
    // Eventos principales
    document.getElementById('placeholder').addEventListener('click', function() {
      if (!escribiendo) {
        escribiendo = true;
        this.style.display = 'none';
        escribirMensaje();
      }
    });
    
    document.querySelector('.boton-entrar').addEventListener('click', function() {
      document.querySelector('.layout').style.display = 'none';
      document.getElementById('timelineScreen').style.display = 'flex';
      generarTimeline();
    });
    
    document.getElementById('botonVolver').addEventListener('click', function() {
      document.getElementById('timelineScreen').style.display = 'none';
      document.querySelector('.layout').style.display = 'flex';
    });
    
    // Eventos para audio mejorado
    botonPlayPause.addEventListener('click', togglePlayPause);
    barraProgreso.addEventListener('click', establecerProgreso);
    barraProgreso.addEventListener('mousemove', actualizarTiempoHover);
    barraProgreso.addEventListener('touchmove', function(event) {
      // Para m√≥viles: convertir touch a mouse event
      const touch = event.touches[0];
      const mouseEvent = new MouseEvent('mousemove', {
        clientX: touch.clientX,
        clientY: touch.clientY
      });
      barraProgreso.dispatchEvent(mouseEvent);
    });
    
    // Cuando termina la reproducci√≥n, reiniciar a play
    audio.addEventListener('ended', function() {
      iconoPlayPause.className = 'fas fa-play';
      botonPlayPause.classList.remove('playing');
      tiempoActual.textContent = `0:00 / ${formatearTiempo(audio.duration)}`;
      progresoActual.style.width = '0%';
    });
    
    audio.addEventListener('timeupdate', actualizarInterfazAudio);
    audio.addEventListener('loadedmetadata', actualizarInterfazAudio);
    
    // ===== EVENTOS PARA EL √ÅLBUM - NUEVO =====
    document.getElementById('botonAlbum').addEventListener('click', mostrarAlbum);
    document.getElementById('cerrarModal').addEventListener('click', cerrarAlbum);
    document.getElementById('cerrarAmpliada').addEventListener('click', cerrarFotoAmpliada);
    
    // Cerrar modales al hacer clic fuera
    document.getElementById('modalAlbum').addEventListener('click', function(e) {
      if (e.target === this) cerrarAlbum();
    });
    
    document.getElementById('modalAmpliada').addEventListener('click', function(e) {
      if (e.target === this) cerrarFotoAmpliada();
    });
    
    // ===== EVENTOS PARA ACTUALIZACI√ìN - NUEVO =====
    document.getElementById('botonActualizarAhora').addEventListener('click', actualizarPWA);
    document.getElementById('cerrarNotificacion').addEventListener('click', ocultarNotificacionUpdate);
    
    // ===== SISTEMA DE SERVICE WORKER CON ACTUALIZACI√ìN - NUEVO =====
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('sw.js')
        .then(reg => {
          registrationSW = reg;
          console.log('SW registrado:', reg.scope);
          
          // Chequear actualizaciones cada 5 minutos
          setInterval(chequearActualizaciones, 5 * 60 * 1000);
          
          // Detectar nueva versi√≥n
          reg.addEventListener('updatefound', () => {
            const newWorker = reg.installing;
            
            newWorker.addEventListener('statechange', () => {
              if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                mostrarNotificacionUpdate();
              }
            });
          });
        })
        .catch(error => {
          console.log('Error SW:', error);
        });
      
      // Escuchar mensajes del Service Worker
      navigator.serviceWorker.addEventListener('message', event => {
        if (event.data === 'update') {
          mostrarNotificacionUpdate();
        }
      });
      
      // Forzar actualizaci√≥n cuando la app vuelve a estar visible
      document.addEventListener('visibilitychange', () => {
        if (!document.hidden && registrationSW) {
          registrationSW.update();
        }
      });
    }
    
    // ===== FIN DE NUEVOS EVENTOS =====
    
    // Iniciar
    actualizarTiempo();
    setInterval(actualizarTiempo, 60000);
    setInterval(() => {
      if (document.getElementById('timelineScreen').style.display === 'flex') {
        generarTimeline();
      }
    }, 3600000);
    
    // Actualizar interfaz de audio cada 100ms para progreso suave
    setInterval(actualizarInterfazAudio, 100);
  });
  </script>
</body>
</html>